# Solarwinds Extension

<!-- distribution links hack -->
[verified]: https://github.com/solarwinds/solarwinds-otel-collector-releases#verified
[playground]: https://github.com/solarwinds/solarwinds-otel-collector-releases#playground
[k8s]: https://github.com/solarwinds/solarwinds-otel-collector-releases#k8s

<!-- status autogenerated section -->
| Status        |           |
| ------------- |-----------|
| Stability     | [development]  |
| Distributions | [k8s], [playground], [verified] |
| Issues        | [![Open issues](https://img.shields.io/github/issues-search/solarwinds/solarwinds-otel-collector-contrib?query=is%3Aissue%20is%3Aopen%20label%3Aextension%2Fsolarwinds%20&label=open&color=orange&logo=opentelemetry)](https://github.com/solarwinds/solarwinds-otel-collector-contrib/issues?q=is%3Aopen+is%3Aissue+label%3Aextension%2Fsolarwinds) [![Closed issues](https://img.shields.io/github/issues-search/solarwinds/solarwinds-otel-collector-contrib?query=is%3Aissue%20is%3Aclosed%20label%3Aextension%2Fsolarwinds%20&label=closed&color=blue&logo=opentelemetry)](https://github.com/solarwinds/solarwinds-otel-collector-contrib/issues?q=is%3Aclosed+is%3Aissue+label%3Aextension%2Fsolarwinds) |

[development]: https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/component-stability.md#development
[k8s]: https://github.com/open-telemetry/opentelemetry-collector-releases/tree/main/distributions/otelcol-k8s
[playground]: 
[verified]: 
<!-- end autogenerated section -->

The SolarWinds Extension offers capabilities related to the SolarWinds Observability SaaS platform and it is required for the [SolarWinds Processor](../../processor/solarwindsprocessor) to function properly.

Also if gRPC setup is configured with anchor (called `grpc_settings`) it can be used for smaller configuration of standard `otlp` exporter (for details see [Getting Started... configuration](#getting-started)).

It provides these features:

- Heartbeat signal
  - It's a standard metric: `sw.otecol.uptime`
    - The value is a time from the start of the collector in seconds
  - This signal is necessary for SolarWinds Observability SaaS to detect the collector when installed and to determine if it's still alive.
  - It also contains some additional information as resource attributes for SolarWinds Observability SaaS:
    - Collector name: `sw.otelcol.collector.name`

## Getting Started

You just need to include the SolarWinds Extension in your extension definitions and provide the following configuration:

```yaml
extensions:
  solarwinds:
    collector_name: "Collector Name"
    grpc:
      endpoint: "otel.collector.na-01.cloud.solarwinds.com:443"
      tls:
        insecure: false
      headers: {"Authorization": "Bearer ${env:SOLARWINDS_TOKEN}"}
    resource:
        custom_attribute_1: "some optional value 1"
        custom_attribute_2: "some optional value 2"
```

- `collector_name` (mandatory) - The collector name passed in the heartbeat metric (as `sw.otelcol.collector.name` resource attribute) to identify the collector.
- `resource` (optional) - You can specify additional attributes to be added to the `sw.otecol.uptime` metric. 
- `without_entity` (optional) - You can disable Collector entity creation in SolarWinds Observability by setting it to `true`. If not configured, entity creation is enabled by default.
- `grpc` (mandatory) - Provides connection configuration for the extension and if anchor is used (for details see [gRPC Anchoring](#grpc-anchoring)), it can be applied to `otlp` exporter without any further setup.
  - `endpoint` is ingestion endpoint url. Regarding [documentation](https://documentation.solarwinds.com/en/success_center/observability/content/system_requirements/endpoints.htm#Find) we recognize following urls:
    -  for `na-01` environment: `otel.collector.na-01.cloud.solarwinds.com:443`
    -  for `na-02` environment: `otel.collector.na-02.cloud.solarwinds.com:443`
    -  for `eu-01` environment: `otel.collector.eu-01.cloud.solarwinds.com:443`
    -  for `ap-01` environment: `otel.collector.ap-01.cloud.solarwinds.com:443`
  - `tls` section includes general TLS configuration options; however, connecting to SolarWinds Observability requires that a secure connection is enforced by setting `insecure: false`.
  - `headers` contains API token in a form `headers: {"Authorization": "Bearer ${env:SOLARWINDS_TOKEN}"}`. You can generate your token in your SolarWinds Observability SaaS account under _Settings / API Tokens / Create API Token_. The type is "Ingestion". You can find the complete documentation [here](https://documentation.solarwinds.com/en/success_center/observability/content/settings/api-tokens.htm).
### gRPC Anchoring
Proposed compact solution how to easily re-use gRPC configuration from `solarwinds` extension in `otlp` exporter. Such combination is currently preferred solution for SolarWinds OTEL Collector.
```
extensions:
  solarwinds:
    collector_name: "your-collector-name"
    grpc: &grpc_settings
      endpoint: "otel-url-endpoint"
      tls:
        insecure: false
      headers: {"Authorization": "Bearer ${env:SOLARWINDS_TOKEN}"}

exporters:
  otlp:
    <<: *grpc_settings
```

## Development
- **Tests** can be executed with `make test`.
- After changes to `metadata.yaml` generated files need to be re-generated with `make generate`. The [mdatagen](http://go.opentelemetry.io/collector/cmd/mdatagen) tool has to be in the `PATH`.
